<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>命运斗争任务追踪器</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-color: #3498db;
            --secondary-color: #2ecc71;
            --danger-color: #e74c3c;
            --dark-color: #2c3e50;
            --light-color: #ecf0f1;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f7fa;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
            background-color: var(--dark-color);
            color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            position: relative;
        }
        
        h1 {
            margin: 0;
            font-size: 2.5rem;
        }
        
        .subtitle {
            font-style: italic;
            margin-top: 10px;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stats-card {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            text-align: center;
        }
        
        .stars-count {
            font-size: 3rem;
            font-weight: bold;
            margin: 20px 0;
            color: #2c3e50;
        }
        
        .task-form {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        
        input[type="text"], input[type="date"], input[type="password"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 1rem;
        }
        
        button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #2980b9;
        }
        
        button:disabled {
            background-color: #95a5a6;
            cursor: not-allowed;
        }
        
        .tasks-list {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }
        
        .task-item {
            display: flex;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #eee;
        }
        
        .task-item:last-child {
            border-bottom: none;
        }
        
        .task-checkbox {
            margin-right: 15px;
            transform: scale(1.5);
        }
        
        .task-text {
            flex-grow: 1;
        }
        
        .completed {
            text-decoration: line-through;
            color: #7f8c8d;
        }
        
        .chart-container {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
            position: relative;
            height: 400px;
        }
        
        .time-navigation {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal-content {
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            width: 80%;
            max-width: 600px;
            max-height: 80%;
            overflow-y: auto;
        }
        
        .close-modal {
            float: right;
            font-size: 1.5rem;
            font-weight: bold;
            cursor: pointer;
        }
        
        .day-details {
            margin-top: 20px;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            background-color: var(--danger-color);
            color: white;
            border-radius: 4px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            display: none;
            z-index: 1100;
        }
        
        .reset-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            background-color: var(--danger-color);
        }
        
        .reset-btn:hover {
            background-color: #c0392b;
        }
        
        .modal-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        
        .modal-btn {
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
        }
        
        .modal-confirm {
            background-color: var(--danger-color);
            color: white;
            border: none;
        }
        
        .modal-cancel {
            background-color: #bdc3c7;
            color: white;
            border: none;
        }
        
        .password-error {
            color: var(--danger-color);
            margin-top: 5px;
            display: none;
        }
        
        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .reset-btn {
                position: static;
                margin-top: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>命运斗争任务追踪器</h1>
            <p class="subtitle">每日完成任务，积累星星，从命运手中夺回自己的人生！</p>
            <button id="reset-data-btn" class="reset-btn">清空历史数据</button>
        </header>
        
        <div class="dashboard">
            <div class="stats-card">
                <h2>当前星星数</h2>
                <div id="stars-count" class="stars-count">0</div>
                <p id="motivational-text">开始积累你的星星吧！</p>
            </div>
            
            <div class="stats-card">
                <h2>今日状态</h2>
                <p id="current-date">加载中...</p>
                <p id="task-setting-status">检查任务设置时间...</p>
                <p id="tasks-summary">今日任务: 0 已设置, 0 已完成</p>
            </div>
        </div>
        
        <div class="task-form">
            <h2>添加今日任务</h2>
            <p id="form-instruction">请在下方输入你的任务</p>
            <div class="form-group">
                <label for="new-task">任务描述:</label>
                <input type="text" id="new-task" placeholder="输入你的任务...">
            </div>
            <button id="add-task-btn">添加任务</button>
        </div>
        
        <div class="tasks-list">
            <h2>今日任务</h2>
            <div id="tasks-container">
                <!-- 任务将通过JavaScript动态生成 -->
                <p id="no-tasks-message">今天还没有设置任何任务。</p>
            </div>
        </div>
        
        <div class="chart-container">
            <h2>任务完成历史</h2>
            <div class="time-navigation">
                <button id="prev-period">← 前一周</button>
                <span id="chart-period">本周</span>
                <button id="next-period">下一周 →</button>
            </div>
            <canvas id="tasks-chart"></canvas>
        </div>
    </div>
    
    <div id="day-detail-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2 id="modal-date">日期详情</h2>
            <div id="day-details" class="day-details">
                <!-- 详情内容将通过JavaScript动态生成 -->
            </div>
        </div>
    </div>
    
    <!-- 密码验证模态框 -->
    <div id="password-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>验证身份</h2>
            <p>请输入密码以确认清空数据操作</p>
            <div class="form-group">
                <label for="reset-password">密码:</label>
                <input type="password" id="reset-password" placeholder="请输入密码...">
                <p id="password-error" class="password-error">密码错误，请重新输入！</p>
            </div>
            <div class="modal-buttons">
                <button id="verify-password-btn" class="modal-btn modal-confirm">验证</button>
                <button id="cancel-password-btn" class="modal-btn modal-cancel">取消</button>
            </div>
        </div>
    </div>
    
    <div id="reset-confirm-modal" class="modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>确认清空数据</h2>
            <p>您确定要清空所有历史数据吗？这个操作无法撤销！</p>
            <p>所有任务记录和星星数量将被重置。</p>
            <div class="modal-buttons">
                <button id="confirm-reset-btn" class="modal-btn modal-confirm">确认清空</button>
                <button id="cancel-reset-btn" class="modal-btn modal-cancel">取消</button>
            </div>
        </div>
    </div>
    
    <div id="notification" class="notification">
        消息通知
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 初始化变量
            let currentStars = 0;
            let todayTasks = [];
            let historyData = {};
            let currentChartPeriod = 0; // 0表示当前周，负数表示过去，正数表示未来
            
            // DOM元素
            const starsCountEl = document.getElementById('stars-count');
            const motivationalText = document.getElementById('motivational-text');
            const currentDateEl = document.getElementById('current-date');
            const taskSettingStatus = document.getElementById('task-setting-status');
            const tasksSummary = document.getElementById('tasks-summary');
            const newTaskInput = document.getElementById('new-task');
            const addTaskBtn = document.getElementById('add-task-btn');
            const tasksContainer = document.getElementById('tasks-container');
            const noTasksMessage = document.getElementById('no-tasks-message');
            const tasksChart = document.getElementById('tasks-chart');
            const chartPeriod = document.getElementById('chart-period');
            const prevPeriodBtn = document.getElementById('prev-period');
            const nextPeriodBtn = document.getElementById('next-period');
            const dayDetailModal = document.getElementById('day-detail-modal');
            const modalDate = document.getElementById('modal-date');
            const dayDetails = document.getElementById('day-details');
            const notification = document.getElementById('notification');
            const resetDataBtn = document.getElementById('reset-data-btn');
            const passwordModal = document.getElementById('password-modal');
            const resetPasswordInput = document.getElementById('reset-password');
            const passwordError = document.getElementById('password-error');
            const verifyPasswordBtn = document.getElementById('verify-password-btn');
            const cancelPasswordBtn = document.getElementById('cancel-password-btn');
            const resetConfirmModal = document.getElementById('reset-confirm-modal');
            const confirmResetBtn = document.getElementById('confirm-reset-btn');
            const cancelResetBtn = document.getElementById('cancel-reset-btn');
            
            // Chart.js实例
            let tasksChartInstance;
            
            // 初始化应用
            function initApp() {
                loadData();
                updateDateTime();
                checkTaskSettingTime();
                renderStars();
                renderTasks();
                updateTasksSummary();
                initChart();
                setupEventListeners();
                
                // 检查是否需要每日结算
                checkDailySettlement();
            }
            
            // 从localStorage加载数据
            function loadData() {
                // 加载星星数
                const savedStars = localStorage.getItem('starsCount');
                if (savedStars !== null) {
                    currentStars = parseInt(savedStars);
                }
                
                // 加载今日任务
                const today = getTodayDateString();
                const savedTodayTasks = localStorage.getItem(`tasks_${today}`);
                if (savedTodayTasks !== null) {
                    todayTasks = JSON.parse(savedTodayTasks);
                }
                
                // 加载历史数据
                const savedHistory = localStorage.getItem('tasksHistory');
                if (savedHistory !== null) {
                    historyData = JSON.parse(savedHistory);
                }
            }
            
            // 保存数据到localStorage
            function saveData() {
                localStorage.setItem('starsCount', currentStars.toString());
                
                const today = getTodayDateString();
                localStorage.setItem(`tasks_${today}`, JSON.stringify(todayTasks));
                
                localStorage.setItem('tasksHistory', JSON.stringify(historyData));
            }
            
            // 获取今日日期字符串 (YYYY-MM-DD)
            function getTodayDateString() {
                const now = new Date();
                return now.toISOString().split('T')[0];
            }
            
            // 更新日期和时间显示
            function updateDateTime() {
                const now = new Date();
                const options = { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' };
                currentDateEl.textContent = now.toLocaleDateString('zh-CN', options);
            }
            
            // 检查任务设置时间 - 7点前可设置，7点后不可设置
            function checkTaskSettingTime() {
                const now = new Date();
                const hours = now.getHours();
                
                if (hours >= 100) {
                    // 7点后，不能设置任务
                    taskSettingStatus.textContent = "今日100点后不可再设置任务，请明日100点前设置";
                    taskSettingStatus.style.color = "var(--danger-color)";
                    newTaskInput.disabled = true;
                    addTaskBtn.disabled = true;
                } else {
                    // 7点前，可以设置任务
                    taskSettingStatus.textContent = "请在今日100点前设置任务";
                    taskSettingStatus.style.color = "var(--secondary-color)";
                    newTaskInput.disabled = false;
                    addTaskBtn.disabled = false;
                }
            }
            
            // 渲染星星（仅显示数字）
            function renderStars() {
                starsCountEl.textContent = currentStars;
                
                // 更新激励文本
                if (currentStars >= 100) {
                    motivationalText.textContent = "你已完全掌控自己的命运！";
                } else if (currentStars >= 50) {
                    motivationalText.textContent = "命运已在你手中，继续前进！";
                } else if (currentStars >= 20) {
                    motivationalText.textContent = "你正在夺回人生的控制权！";
                } else if (currentStars >= 10) {
                    motivationalText.textContent = "星星在积累，命运在改变！";
                } else if (currentStars >= 0) {
                    motivationalText.textContent = "开始积累你的星星吧！";
                } else if (currentStars >= -10) {
                    motivationalText.textContent = "不要放弃，命运正在考验你！";
                } else {
                    motivationalText.textContent = "坚持斗争，不要向命运屈服！";
                }
            }
            
            // 渲染任务列表
            function renderTasks() {
                tasksContainer.innerHTML = '';
                
                if (todayTasks.length === 0) {
                    noTasksMessage.style.display = 'block';
                    return;
                }
                
                noTasksMessage.style.display = 'none';
                
                todayTasks.forEach((task, index) => {
                    const taskItem = document.createElement('div');
                    taskItem.className = 'task-item';
                    
                    const checkbox = document.createElement('input');
                    checkbox.type = 'checkbox';
                    checkbox.className = 'task-checkbox';
                    checkbox.checked = task.completed;
                    checkbox.addEventListener('change', () => toggleTaskCompletion(index));
                    
                    const taskText = document.createElement('span');
                    taskText.className = `task-text ${task.completed ? 'completed' : ''}`;
                    taskText.textContent = task.text;
                    
                    taskItem.appendChild(checkbox);
                    taskItem.appendChild(taskText);
                    
                    tasksContainer.appendChild(taskItem);
                });
            }
            
            // 更新任务摘要
            function updateTasksSummary() {
                const totalTasks = todayTasks.length;
                const completedTasks = todayTasks.filter(task => task.completed).length;
                
                tasksSummary.textContent = `今日任务: ${totalTasks} 已设置, ${completedTasks} 已完成`;
            }
            
            // 添加新任务
            function addNewTask() {
                const taskText = newTaskInput.value.trim();
                
                if (taskText === '') {
                    showNotification('任务描述不能为空');
                    return;
                }
                
                todayTasks.push({
                    text: taskText,
                    completed: false
                });
                
                newTaskInput.value = '';
                renderTasks();
                updateTasksSummary();
                saveData();
            }
            
            // 切换任务完成状态
            function toggleTaskCompletion(index) {
                todayTasks[index].completed = !todayTasks[index].completed;
                
                // 如果是标记为完成，增加星星；如果是取消完成，减少星星
                if (todayTasks[index].completed) {
                    currentStars++;
                    showNotification('任务完成！+1⭐');
                } else {
                    currentStars--;
                    showNotification('取消完成任务！-1⭐');
                }
                
                renderStars();
                renderTasks();
                updateTasksSummary();
                saveData();
                updateChart();
            }
            
            // 检查每日结算
            function checkDailySettlement() {
                const lastSettlement = localStorage.getItem('lastSettlement');
                const today = getTodayDateString();
                
                if (lastSettlement !== today) {
                    // 新的一天，进行结算
                    performDailySettlement();
                    localStorage.setItem('lastSettlement', today);
                }
            }
            
            // 执行每日结算
            function performDailySettlement() {
                const yesterday = new Date();
                yesterday.setDate(yesterday.getDate() - 1);
                const yesterdayString = yesterday.toISOString().split('T')[0];
                
                // 获取昨天的任务
                const yesterdayTasks = JSON.parse(localStorage.getItem(`tasks_${yesterdayString}`) || '[]');
                
                // 记录历史数据
                const completedCount = yesterdayTasks.filter(task => task.completed).length;
                historyData[yesterdayString] = {
                    totalTasks: yesterdayTasks.length,
                    completedTasks: completedCount
                };
                
                // 计算星星变化
                if (yesterdayTasks.length === 0) {
                    // 没有设置任务，扣一颗星
                    currentStars--;
                    showNotification('昨日未设置任何任务！-1⭐');
                } else {
                    // 计算完成和未完成的任务
                    const uncompletedTasks = yesterdayTasks.filter(task => !task.completed).length;
                    
                    // 每个完成的任务加一颗星，每个未完成的任务减一颗星
                    const starChange = completedCount - uncompletedTasks;
                    currentStars += starChange;
                    
                    if (starChange > 0) {
                        showNotification(`昨日任务结算：+${starChange}⭐`);
                    } else if (starChange < 0) {
                        showNotification(`昨日任务结算：${starChange}⭐`);
                    } else {
                        showNotification('昨日任务结算：无变化');
                    }
                }
                
                renderStars();
                saveData();
                updateChart();
            }
            
            // 初始化图表
            function initChart() {
                const ctx = tasksChart.getContext('2d');
                
                tasksChartInstance = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: [],
                        datasets: [{
                            label: '完成任务数量',
                            data: [],
                            backgroundColor: 'rgba(46, 204, 113, 0.2)',
                            borderColor: 'rgba(46, 204, 113, 1)',
                            borderWidth: 2,
                            pointBackgroundColor: 'rgba(46, 204, 113, 1)',
                            pointBorderColor: '#fff',
                            pointHoverBackgroundColor: '#fff',
                            pointHoverBorderColor: 'rgba(46, 204, 113, 1)',
                            pointRadius: 5,
                            pointHoverRadius: 7
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: '完成任务数'
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: '日期'
                                }
                            }
                        },
                        plugins: {
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return `完成任务: ${context.raw}`;
                                    }
                                }
                            }
                        },
                        onClick: function(e, elements) {
                            if (elements.length > 0) {
                                const index = elements[0].index;
                                const date = this.data.labels[index];
                                showDayDetails(date);
                            }
                        }
                    }
                });
                
                updateChart();
            }
            
            // 更新图表数据
            function updateChart() {
                // 获取最近两周的日期
                const dates = [];
                const completedData = [];
                
                const today = new Date();
                for (let i = 13 + currentChartPeriod * 7; i >= currentChartPeriod * 7; i--) {
                    const date = new Date();
                    date.setDate(today.getDate() - i);
                    const dateString = date.toISOString().split('T')[0];
                    
                    dates.push(dateString);
                    
                    if (historyData[dateString]) {
                        completedData.push(historyData[dateString].completedTasks);
                    } else {
                        completedData.push(null);
                    }
                }
                
                tasksChartInstance.data.labels = dates;
                tasksChartInstance.data.datasets[0].data = completedData;
                tasksChartInstance.update();
                
                // 更新图表期间显示
                if (currentChartPeriod === 0) {
                    chartPeriod.textContent = "本周";
                } else if (currentChartPeriod === -1) {
                    chartPeriod.textContent = "上周";
                } else if (currentChartPeriod < -1) {
                    chartPeriod.textContent = `${Math.abs(currentChartPeriod)}周前`;
                } else {
                    chartPeriod.textContent = `未来第${currentChartPeriod}周`;
                }
                
                // 禁用未来的导航按钮
                nextPeriodBtn.disabled = currentChartPeriod >= 0;
            }
            
            // 显示某天的详情
            function showDayDetails(dateString) {
                const date = new Date(dateString);
                const options = { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' };
                modalDate.textContent = date.toLocaleDateString('zh-CN', options);
                
                dayDetails.innerHTML = '';
                
                if (historyData[dateString]) {
                    const data = historyData[dateString];
                    
                    const summary = document.createElement('p');
                    summary.innerHTML = `<strong>完成任务:</strong> ${data.completedTasks}/${data.totalTasks}`;
                    dayDetails.appendChild(summary);
                    
                    // 尝试获取当天的任务列表
                    const tasks = JSON.parse(localStorage.getItem(`tasks_${dateString}`) || '[]');
                    
                    if (tasks.length > 0) {
                        const tasksHeader = document.createElement('h3');
                        tasksHeader.textContent = "任务列表:";
                        dayDetails.appendChild(tasksHeader);
                        
                        const tasksList = document.createElement('ul');
                        tasks.forEach(task => {
                            const taskItem = document.createElement('li');
                            taskItem.style.textDecoration = task.completed ? 'line-through' : 'none';
                            taskItem.textContent = task.text;
                            tasksList.appendChild(taskItem);
                        });
                        
                        dayDetails.appendChild(tasksList);
                    }
                } else {
                    const noData = document.createElement('p');
                    noData.textContent = "这一天没有记录数据。";
                    dayDetails.appendChild(noData);
                }
                
                dayDetailModal.style.display = 'flex';
            }
            
            // 显示通知
            function showNotification(message) {
                notification.textContent = message;
                notification.style.display = 'block';
                
                setTimeout(() => {
                    notification.style.display = 'none';
                }, 3000);
            }
            
            // 清空所有数据
            function resetAllData() {
                // 清空localStorage
                localStorage.clear();
                
                // 重置变量
                currentStars = 0;
                todayTasks = [];
                historyData = {};
                currentChartPeriod = 0;
                
                // 保存空数据
                saveData();
                
                // 重新渲染界面
                renderStars();
                renderTasks();
                updateTasksSummary();
                updateChart();
                
                // 显示成功消息
                showNotification('所有数据已成功清空！');
            }
            
            // 验证密码
            function verifyPassword() {
                const password = resetPasswordInput.value.trim();
                
                if (password === '611814') {
                    // 密码正确，显示确认对话框
                    passwordModal.style.display = 'none';
                    resetConfirmModal.style.display = 'flex';
                    resetPasswordInput.value = '';
                    passwordError.style.display = 'none';
                } else {
                    // 密码错误，显示错误信息
                    passwordError.style.display = 'block';
                }
            }
            
            // 设置事件监听器
            function setupEventListeners() {
                addTaskBtn.addEventListener('click', addNewTask);
                
                newTaskInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        addNewTask();
                    }
                });
                
                prevPeriodBtn.addEventListener('click', () => {
                    currentChartPeriod--;
                    updateChart();
                });
                
                nextPeriodBtn.addEventListener('click', () => {
                    currentChartPeriod++;
                    updateChart();
                });
                
                document.querySelectorAll('.close-modal').forEach(closeBtn => {
                    closeBtn.addEventListener('click', function() {
                        this.closest('.modal').style.display = 'none';
                    });
                });
                
                window.addEventListener('click', (e) => {
                    if (e.target.classList.contains('modal')) {
                        e.target.style.display = 'none';
                        // 重置密码输入框和错误信息
                        resetPasswordInput.value = '';
                        passwordError.style.display = 'none';
                    }
                });
                
                // 清空数据按钮事件
                resetDataBtn.addEventListener('click', () => {
                    passwordModal.style.display = 'flex';
                });
                
                // 密码验证按钮事件
                verifyPasswordBtn.addEventListener('click', verifyPassword);
                
                resetPasswordInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        verifyPassword();
                    }
                });
                
                cancelPasswordBtn.addEventListener('click', () => {
                    passwordModal.style.display = 'none';
                    resetPasswordInput.value = '';
                    passwordError.style.display = 'none';
                });
                
                confirmResetBtn.addEventListener('click', () => {
                    resetAllData();
                    resetConfirmModal.style.display = 'none';
                });
                
                cancelResetBtn.addEventListener('click', () => {
                    resetConfirmModal.style.display = 'none';
                });
                
                // 每分钟更新一次时间
                setInterval(() => {
                    updateDateTime();
                    checkTaskSettingTime();
                }, 60000);
            }
            
            // 启动应用
            initApp();
        });
    </script>
</body>
</html>